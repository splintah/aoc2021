<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Day04</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--guardedness</a> <a id="27" class="Symbol">#-}</a>

<a id="32" class="Keyword">module</a> <a id="39" href="Day04.html" class="Module">Day04</a> <a id="45" class="Keyword">where</a>

<a id="52" class="Keyword">open</a> <a id="57" class="Keyword">import</a> <a id="64" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="74" class="Symbol">as</a> <a id="77" class="Module">Bool</a>
<a id="82" class="Keyword">open</a> <a id="87" class="Keyword">import</a> <a id="94" href="Data.List.html" class="Module">Data.List</a> <a id="104" class="Symbol">as</a> <a id="107" class="Module">List</a> <a id="112" class="Keyword">using</a> <a id="118" class="Symbol">(</a><a id="119" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="123" class="Symbol">;</a> <a id="125" href="Data.List.Base.html#10383" class="InductiveConstructor">[]</a><a id="127" class="Symbol">;</a> <a id="129" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="132" class="Symbol">)</a>
<a id="134" class="Keyword">open</a> <a id="139" class="Keyword">import</a> <a id="146" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="165" class="Symbol">as</a> <a id="168" class="Module">List⁺</a> <a id="174" class="Keyword">using</a> <a id="180" class="Symbol">(</a><a id="181" href="Data.List.NonEmpty.Base.html#1079" class="Record">List⁺</a><a id="186" class="Symbol">)</a>
<a id="188" class="Keyword">open</a> <a id="193" class="Keyword">import</a> <a id="200" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="211" class="Symbol">as</a> <a id="214" class="Module">Maybe</a> <a id="220" class="Keyword">using</a> <a id="226" class="Symbol">(</a><a id="227" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="232" class="Symbol">;</a> <a id="234" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="241" class="Symbol">;</a> <a id="243" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a><a id="247" class="Symbol">)</a>
<a id="249" class="Keyword">open</a> <a id="254" class="Keyword">import</a> <a id="261" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="270" class="Symbol">as</a> <a id="273" class="Module">ℕ</a>
<a id="275" class="Keyword">open</a> <a id="280" class="Keyword">import</a> <a id="287" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a> <a id="301" class="Symbol">as</a> <a id="304" class="Module">ℕ</a>
<a id="306" class="Keyword">open</a> <a id="311" class="Keyword">import</a> <a id="318" href="Data.Product.html" class="Module">Data.Product</a> <a id="331" class="Symbol">as</a> <a id="334" class="Module">×</a> <a id="336" class="Keyword">using</a> <a id="342" class="Symbol">(</a><a id="343" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="346" class="Symbol">;</a> <a id="348" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="351" class="Symbol">;</a> <a id="353" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a><a id="358" class="Symbol">;</a> <a id="360" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="365" class="Symbol">;</a> <a id="367" href="Data.Product.html#3422" class="Function">uncurry</a><a id="374" class="Symbol">)</a>
<a id="376" class="Keyword">open</a> <a id="381" class="Keyword">import</a> <a id="388" href="Data.String.html" class="Module">Data.String</a> <a id="400" class="Symbol">as</a> <a id="403" class="Module">String</a> <a id="410" class="Keyword">using</a> <a id="416" class="Symbol">(</a><a id="417" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="423" class="Symbol">)</a>
<a id="425" class="Keyword">open</a> <a id="430" class="Keyword">import</a> <a id="437" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="454" class="Keyword">using</a> <a id="460" class="Symbol">(</a><a id="461" href="Relation.Nullary.html#1581" class="Field">does</a><a id="465" class="Symbol">;</a> <a id="467" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a><a id="469" class="Symbol">;</a> <a id="471" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a><a id="474" class="Symbol">)</a>
<a id="476" class="Keyword">open</a> <a id="481" class="Keyword">import</a> <a id="488" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="497" class="Symbol">as</a> <a id="500" class="Module">Vec</a> <a id="504" class="Keyword">using</a> <a id="510" class="Symbol">(</a><a id="511" href="Data.Vec.Base.html#998" class="Datatype">Vec</a><a id="514" class="Symbol">;</a> <a id="516" href="Data.Vec.Base.html#1034" class="InductiveConstructor">[]</a><a id="518" class="Symbol">;</a> <a id="520" href="Data.Vec.Base.html#1053" class="InductiveConstructor Operator">_∷_</a><a id="523" class="Symbol">)</a>
<a id="525" class="Keyword">open</a> <a id="530" class="Keyword">import</a> <a id="537" href="Function.html" class="Module">Function</a>
<a id="546" class="Keyword">open</a> <a id="551" class="Keyword">import</a> <a id="558" href="Level.html" class="Module">Level</a> <a id="564" class="Symbol">as</a> <a id="567" class="Module">Level</a>

<a id="574" class="Keyword">open</a> <a id="579" class="Keyword">import</a> <a id="586" href="Base.html" class="Module">Base</a>
<a id="591" class="Keyword">open</a> <a id="596" class="Keyword">import</a> <a id="603" href="Util.html" class="Module">Util</a>

<a id="609" class="Keyword">record</a> <a id="Board"></a><a id="616" href="Day04.html#616" class="Record">Board</a> <a id="622" class="Symbol">:</a> <a id="624" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="628" class="Keyword">where</a>
  <a id="636" class="Keyword">constructor</a> <a id="mkBoard"></a><a id="648" href="Day04.html#648" class="InductiveConstructor">mkBoard</a>
  <a id="658" class="Keyword">field</a>
    <a id="Board.board"></a><a id="668" href="Day04.html#668" class="Field">board</a> <a id="674" class="Symbol">:</a> <a id="676" href="Data.Vec.Base.html#998" class="Datatype">Vec</a> <a id="680" class="Symbol">(</a><a id="681" href="Data.Vec.Base.html#998" class="Datatype">Vec</a> <a id="685" class="Symbol">(</a><a id="686" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="688" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="690" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="694" class="Symbol">)</a> <a id="696" class="Number">5</a><a id="697" class="Symbol">)</a> <a id="699" class="Number">5</a>

  <a id="Board.won?"></a><a id="704" href="Day04.html#704" class="Function">won?</a> <a id="709" class="Symbol">:</a> <a id="711" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
  <a id="718" href="Day04.html#704" class="Function">won?</a> <a id="723" class="Symbol">=</a> <a id="725" href="Relation.Nullary.html#1581" class="Field">does</a> <a id="730" class="Symbol">(</a><a id="731" href="Data.Vec.Relation.Unary.Any.html#2572" class="Function">any?</a> <a id="736" class="Symbol">(</a><a id="737" href="Data.Vec.Relation.Unary.All.html#3094" class="Function">all?</a> <a id="742" class="Symbol">(</a><a id="743" href="Data.Bool.Properties.html#15470" class="Function">T?</a> <a id="746" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="748" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="753" class="Symbol">))</a> <a id="756" href="Day04.html#668" class="Field">board</a><a id="761" class="Symbol">)</a>
       <a id="770" href="Data.Bool.Base.html#1044" class="Function Operator">∨</a> <a id="772" href="Relation.Nullary.html#1581" class="Field">does</a> <a id="777" class="Symbol">(</a><a id="778" href="Data.Vec.Relation.Unary.Any.html#2572" class="Function">any?</a> <a id="783" class="Symbol">(</a><a id="784" href="Data.Vec.Relation.Unary.All.html#3094" class="Function">all?</a> <a id="789" class="Symbol">(</a><a id="790" href="Data.Bool.Properties.html#15470" class="Function">T?</a> <a id="793" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="795" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="800" class="Symbol">))</a> <a id="803" class="Symbol">(</a><a id="804" href="Data.Vec.Base.html#8576" class="Function">Vec.transpose</a> <a id="818" href="Day04.html#668" class="Field">board</a><a id="823" class="Symbol">))</a>
    <a id="830" class="Keyword">where</a>
      <a id="842" class="Keyword">open</a> <a id="847" class="Keyword">import</a> <a id="854" href="Data.Vec.Relation.Unary.All.html" class="Module">Data.Vec.Relation.Unary.All</a> <a id="882" class="Keyword">using</a> <a id="888" class="Symbol">(</a><a id="889" href="Data.Vec.Relation.Unary.All.html#3094" class="Function">all?</a><a id="893" class="Symbol">)</a>
      <a id="901" class="Keyword">open</a> <a id="906" class="Keyword">import</a> <a id="913" href="Data.Vec.Relation.Unary.Any.html" class="Module">Data.Vec.Relation.Unary.Any</a> <a id="941" class="Keyword">using</a> <a id="947" class="Symbol">(</a><a id="948" href="Data.Vec.Relation.Unary.Any.html#2572" class="Function">any?</a><a id="952" class="Symbol">)</a>

<a id="955" class="Keyword">open</a> <a id="960" href="Day04.html#616" class="Module">Board</a>

<a id="score"></a><a id="967" href="Day04.html#967" class="Function">score</a> <a id="973" class="Symbol">:</a> <a id="975" href="Day04.html#616" class="Record">Board</a> <a id="981" class="Symbol">→</a> <a id="983" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="985" href="Day04.html#967" class="Function">score</a> <a id="991" class="Symbol">=</a>
    <a id="997" href="Data.List.Base.html#4784" class="Function">List.sum</a>
  <a id="1008" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1010" href="Data.List.Base.html#1544" class="Function">List.map</a> <a id="1019" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a>
  <a id="1027" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1029" href="Data.List.Base.html#8092" class="Function">List.filter</a> <a id="1041" class="Symbol">(</a><a id="1042" href="Data.Bool.Properties.html#1126" class="Function Operator">Bool._≟_</a> <a id="1051" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="1057" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1059" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="1064" class="Symbol">)</a>
  <a id="1068" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1070" href="Data.Vec.Base.html#7438" class="Function">Vec.toList</a>
  <a id="1083" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1085" href="Data.Vec.Base.html#2813" class="Function">Vec.concat</a>
  <a id="1098" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1100" href="Day04.html#668" class="Field">board</a>

<a id="map"></a><a id="1107" href="Day04.html#1107" class="Function">map</a> <a id="1111" class="Symbol">:</a> <a id="1113" class="Symbol">(</a><a id="1114" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1116" class="Symbol">→</a> <a id="1118" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="1123" class="Symbol">→</a> <a id="1125" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1127" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1129" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="1133" class="Symbol">)</a> <a id="1135" class="Symbol">→</a> <a id="1137" href="Day04.html#616" class="Record">Board</a> <a id="1143" class="Symbol">→</a> <a id="1145" href="Day04.html#616" class="Record">Board</a>
<a id="1151" href="Day04.html#1107" class="Function">map</a> <a id="1155" href="Day04.html#1155" class="Bound">f</a> <a id="1157" class="Symbol">=</a> <a id="1159" href="Day04.html#648" class="InductiveConstructor">mkBoard</a> <a id="1167" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1169" href="Data.Vec.Base.html#2580" class="Function">Vec.map</a> <a id="1177" class="Symbol">(</a><a id="1178" href="Data.Vec.Base.html#2580" class="Function">Vec.map</a> <a id="1186" class="Symbol">λ{</a> <a id="1189" class="Symbol">(</a><a id="1190" href="Day04.html#1190" class="Bound">n</a> <a id="1192" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1194" href="Day04.html#1194" class="Bound">m</a><a id="1195" class="Symbol">)</a> <a id="1197" class="Symbol">→</a> <a id="1199" href="Day04.html#1155" class="Bound">f</a> <a id="1201" href="Day04.html#1190" class="Bound">n</a> <a id="1203" href="Day04.html#1194" class="Bound">m</a> <a id="1205" class="Symbol">})</a> <a id="1208" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1210" href="Day04.html#668" class="Field">board</a>

<a id="set"></a><a id="1217" href="Day04.html#1217" class="Function">set</a> <a id="1221" class="Symbol">:</a> <a id="1223" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="1228" class="Symbol">→</a> <a id="1230" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1232" class="Symbol">→</a> <a id="1234" href="Day04.html#616" class="Record">Board</a> <a id="1240" class="Symbol">→</a> <a id="1242" href="Day04.html#616" class="Record">Board</a>
<a id="1248" href="Day04.html#1217" class="Function">set</a> <a id="1252" href="Day04.html#1252" class="Bound">m</a> <a id="1254" href="Day04.html#1254" class="Bound">n</a> <a id="1256" class="Symbol">=</a> <a id="1258" href="Day04.html#1107" class="Function">map</a> <a id="1262" class="Symbol">λ</a> <a id="1264" href="Day04.html#1264" class="Bound">k</a> <a id="1266" href="Day04.html#1266" class="Bound">m′</a> <a id="1269" class="Symbol">→</a> <a id="1271" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="1274" href="Day04.html#1254" class="Bound">n</a> <a id="1276" href="Data.Nat.Base.html#1127" class="Primitive Operator">ℕ.≡ᵇ</a> <a id="1281" href="Day04.html#1264" class="Bound">k</a> <a id="1283" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="1288" class="Symbol">(</a><a id="1289" href="Day04.html#1264" class="Bound">k</a> <a id="1291" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1293" href="Day04.html#1252" class="Bound">m</a><a id="1294" class="Symbol">)</a> <a id="1296" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="1301" class="Symbol">(</a><a id="1302" href="Day04.html#1264" class="Bound">k</a> <a id="1304" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1306" href="Day04.html#1266" class="Bound">m′</a><a id="1308" class="Symbol">)</a>

<a id="mark"></a><a id="1311" href="Day04.html#1311" class="Function">mark</a> <a id="1316" class="Symbol">:</a> <a id="1318" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1320" class="Symbol">→</a> <a id="1322" href="Day04.html#616" class="Record">Board</a> <a id="1328" class="Symbol">→</a> <a id="1330" href="Day04.html#616" class="Record">Board</a>
<a id="1336" href="Day04.html#1311" class="Function">mark</a> <a id="1341" class="Symbol">=</a> <a id="1343" href="Day04.html#1217" class="Function">set</a> <a id="1347" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>

<a id="unmark"></a><a id="1353" href="Day04.html#1353" class="Function">unmark</a> <a id="1360" class="Symbol">:</a> <a id="1362" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1364" class="Symbol">→</a> <a id="1366" href="Day04.html#616" class="Record">Board</a> <a id="1372" class="Symbol">→</a> <a id="1374" href="Day04.html#616" class="Record">Board</a>
<a id="1380" href="Day04.html#1353" class="Function">unmark</a> <a id="1387" class="Symbol">=</a> <a id="1389" href="Day04.html#1217" class="Function">set</a> <a id="1393" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>

<a id="1400" class="Keyword">module</a> <a id="1407" href="Day04.html#1407" class="Module">_</a> <a id="1409" class="Keyword">where</a>
  <a id="1417" class="Keyword">open</a> <a id="1422" class="Keyword">import</a> <a id="1429" href="Text.Parser.html" class="Module">Text.Parser</a> <a id="1441" href="Level.html#512" class="Function">0ℓ</a>
  <a id="1446" class="Keyword">open</a> <a id="1451" class="Keyword">import</a> <a id="1458" href="Relation.Unary.html" class="Module">Relation.Unary</a>

  <a id="1476" href="Day04.html#1476" class="Function">drawsₚ</a> <a id="1483" class="Symbol">:</a> <a id="1485" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="1488" href="Text.Parser.Types.html#564" class="Record">Parser</a> <a id="1495" href="Level.Bounded.html#1072" class="Function Operator">[</a> <a id="1497" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1502" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1504" href="Level.Bounded.html#1072" class="Function Operator">]</a> <a id="1506" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="1510" href="Day04.html#1476" class="Function">drawsₚ</a> <a id="1517" class="Symbol">=</a> <a id="1519" href="Data.List.NonEmpty.Base.html#1521" class="Function">List⁺.toList</a> <a id="1532" href="Text.Parser.Combinators.html#3101" class="Function Operator">&lt;$&gt;</a> <a id="1536" href="Text.Parser.Combinators.html#9287" class="Function">list⁺</a> <a id="1542" class="Symbol">(</a><a id="1543" href="Text.Parser.Combinators.Numbers.html#1682" class="Function">decimalℕ</a> <a id="1552" href="Text.Parser.Combinators.html#5550" class="Function Operator">&lt;&amp;?</a> <a id="1556" href="Text.Parser.Combinators.html#2357" class="Function">box</a> <a id="1560" class="Symbol">(</a><a id="1561" href="Text.Parser.Combinators.Char.html#1190" class="Function">char</a> <a id="1566" class="String">&#39;,&#39;</a><a id="1569" class="Symbol">)</a> <a id="1571" href="Text.Parser.Combinators.html#2489" class="Function Operator">&lt;|&gt;</a> <a id="1575" href="Text.Parser.Combinators.Numbers.html#1682" class="Function">decimalℕ</a><a id="1583" class="Symbol">)</a>

  <a id="1588" href="Day04.html#1588" class="Function">boardₚ</a> <a id="1595" class="Symbol">:</a> <a id="1597" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="1600" href="Text.Parser.Types.html#564" class="Record">Parser</a> <a id="1607" href="Level.Bounded.html#1072" class="Function Operator">[</a> <a id="1609" href="Day04.html#616" class="Record">Board</a> <a id="1615" href="Level.Bounded.html#1072" class="Function Operator">]</a> <a id="1617" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="1621" href="Day04.html#1588" class="Function">boardₚ</a> <a id="1628" class="Symbol">=</a> <a id="1630" href="Day04.html#648" class="InductiveConstructor">mkBoard</a> <a id="1638" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1640" href="Data.Vec.Base.html#2580" class="Function">Vec.map</a> <a id="1648" class="Symbol">(</a><a id="1649" href="Data.Vec.Base.html#2580" class="Function">Vec.map</a> <a id="1657" class="Symbol">(</a><a id="1658" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,</a> <a id="1661" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="1666" class="Symbol">))</a>
    <a id="1673" href="Text.Parser.Combinators.html#3101" class="Function Operator">&lt;$&gt;</a> <a id="1677" href="Text.Parser.Combinators.html#9499" class="Function">replicate</a> <a id="1687" class="Number">5</a> <a id="1689" class="Symbol">(</a><a id="1690" href="Text.Parser.Combinators.html#9499" class="Function">replicate</a> <a id="1700" class="Number">5</a> <a id="1702" class="Symbol">(</a><a id="1703" href="Text.Parser.Combinators.Char.html#1406" class="Function">spaces</a> <a id="1710" href="Text.Parser.Combinators.html#6065" class="Function Operator">?&amp;&gt;</a> <a id="1714" href="Text.Parser.Combinators.Numbers.html#1682" class="Function">decimalℕ</a> <a id="1723" href="Text.Parser.Combinators.html#5550" class="Function Operator">&lt;&amp;?</a> <a id="1727" href="Text.Parser.Combinators.html#2357" class="Function">box</a> <a id="1731" href="Text.Parser.Combinators.Char.html#1406" class="Function">spaces</a><a id="1737" class="Symbol">))</a>

  <a id="1743" href="Day04.html#1743" class="Function">boardsₚ</a> <a id="1751" class="Symbol">:</a> <a id="1753" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="1756" href="Text.Parser.Types.html#564" class="Record">Parser</a> <a id="1763" href="Level.Bounded.html#1072" class="Function Operator">[</a> <a id="1765" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1770" href="Day04.html#616" class="Record">Board</a> <a id="1776" href="Level.Bounded.html#1072" class="Function Operator">]</a> <a id="1778" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="1782" href="Day04.html#1743" class="Function">boardsₚ</a> <a id="1790" class="Symbol">=</a> <a id="1792" href="Data.List.NonEmpty.Base.html#1521" class="Function">List⁺.toList</a> <a id="1805" href="Text.Parser.Combinators.html#3101" class="Function Operator">&lt;$&gt;</a> <a id="1809" href="Text.Parser.Combinators.html#9287" class="Function">list⁺</a> <a id="1815" href="Day04.html#1588" class="Function">boardₚ</a>

  <a id="1825" href="Day04.html#1825" class="Function">parser</a> <a id="1832" class="Symbol">:</a> <a id="1834" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="1837" href="Text.Parser.Types.html#564" class="Record">Parser</a> <a id="1844" href="Level.Bounded.html#1072" class="Function Operator">[</a> <a id="1846" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1851" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1853" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1855" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1860" href="Day04.html#616" class="Record">Board</a> <a id="1866" href="Level.Bounded.html#1072" class="Function Operator">]</a> <a id="1868" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="1872" href="Day04.html#1825" class="Function">parser</a> <a id="1879" class="Symbol">=</a> <a id="1881" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="1885" href="Text.Parser.Combinators.html#3101" class="Function Operator">&lt;$&gt;</a> <a id="1889" href="Day04.html#1476" class="Function">drawsₚ</a> <a id="1896" href="Text.Parser.Combinators.html#4945" class="Function Operator">&lt;*&gt;</a> <a id="1900" href="Text.Parser.Combinators.html#2357" class="Function">box</a> <a id="1904" href="Day04.html#1743" class="Function">boardsₚ</a>

<a id="solve₁′"></a><a id="1913" href="Day04.html#1913" class="Function">solve₁′</a> <a id="1921" class="Symbol">:</a> <a id="1923" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1928" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1930" class="Symbol">→</a> <a id="1932" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1937" href="Day04.html#616" class="Record">Board</a> <a id="1943" class="Symbol">→</a> <a id="1945" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1951" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="1953" href="Day04.html#1913" class="Function">solve₁′</a> <a id="1961" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1964" href="Day04.html#1964" class="Bound">boards</a> <a id="1971" class="Symbol">=</a> <a id="1973" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="1981" href="Day04.html#1913" class="Function">solve₁′</a> <a id="1989" class="Symbol">(</a><a id="1990" href="Day04.html#1990" class="Bound">draw</a> <a id="1995" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1997" href="Day04.html#1997" class="Bound">draws</a><a id="2002" class="Symbol">)</a> <a id="2004" href="Day04.html#2004" class="Bound">boards</a> <a id="2011" class="Symbol">=</a>
  <a id="2015" class="Keyword">let</a>
    <a id="2023" href="Day04.html#2023" class="Bound">boards′</a> <a id="2031" class="Symbol">=</a> <a id="2033" href="Data.List.Base.html#1544" class="Function">List.map</a> <a id="2042" class="Symbol">(</a><a id="2043" href="Day04.html#1311" class="Function">mark</a> <a id="2048" href="Day04.html#1990" class="Bound">draw</a><a id="2052" class="Symbol">)</a> <a id="2054" href="Day04.html#2004" class="Bound">boards</a>
  <a id="2063" class="Keyword">in</a> <a id="2066" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="2071" href="Data.List.Relation.Unary.Any.html#2668" class="Function">any?</a> <a id="2076" class="Symbol">(</a><a id="2077" href="Data.Bool.Properties.html#15470" class="Function">T?</a> <a id="2080" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2082" href="Day04.html#704" class="Function">won?</a><a id="2086" class="Symbol">)</a> <a id="2088" href="Day04.html#2023" class="Bound">boards′</a> <a id="2096" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="2099" class="Symbol">λ</a>
    <a id="2105" class="Symbol">{</a> <a id="2107" class="Symbol">(</a><a id="2108" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="2111" class="Symbol">_)</a> <a id="2114" class="Symbol">→</a> <a id="2116" href="Day04.html#1913" class="Function">solve₁′</a> <a id="2124" href="Day04.html#1997" class="Bound">draws</a> <a id="2130" href="Day04.html#2023" class="Bound">boards′</a>
    <a id="2142" class="Symbol">;</a> <a id="2144" class="Symbol">(</a><a id="2145" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2149" href="Day04.html#2149" class="Bound">any</a><a id="2152" class="Symbol">)</a> <a id="2154" class="Symbol">→</a> <a id="2156" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2161" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="2163" href="Day04.html#1990" class="Bound">draw</a> <a id="2168" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="2170" href="Day04.html#967" class="Function">score</a> <a id="2176" class="Symbol">(</a><a id="2177" href="Data.List.Relation.Unary.Any.html#1919" class="Function">lookup</a> <a id="2184" href="Day04.html#2149" class="Bound">any</a><a id="2187" class="Symbol">)</a>
    <a id="2193" class="Symbol">}</a>
  <a id="2197" class="Keyword">where</a>
    <a id="2207" class="Keyword">open</a> <a id="2212" class="Keyword">import</a> <a id="2219" href="Data.List.Relation.Unary.Any.html" class="Module">Data.List.Relation.Unary.Any</a> <a id="2248" class="Keyword">using</a> <a id="2254" class="Symbol">(</a><a id="2255" href="Data.List.Relation.Unary.Any.html#2668" class="Function">any?</a><a id="2259" class="Symbol">;</a> <a id="2261" href="Data.List.Relation.Unary.Any.html#1919" class="Function">lookup</a><a id="2267" class="Symbol">)</a>

<a id="solve₁"></a><a id="2270" href="Day04.html#2270" class="Function">solve₁</a> <a id="2277" class="Symbol">:</a> <a id="2279" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2284" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2286" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2288" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2293" href="Day04.html#616" class="Record">Board</a> <a id="2299" class="Symbol">→</a> <a id="2301" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2307" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="2309" href="Day04.html#2270" class="Function">solve₁</a> <a id="2316" class="Symbol">=</a> <a id="2318" href="Data.Product.html#3422" class="Function">uncurry</a> <a id="2326" href="Day04.html#1913" class="Function">solve₁′</a>

<a id="solve₂′"></a><a id="2335" href="Day04.html#2335" class="Function">solve₂′</a> <a id="2343" class="Symbol">:</a> <a id="2345" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2350" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2352" class="Symbol">→</a> <a id="2354" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2359" href="Day04.html#616" class="Record">Board</a> <a id="2365" class="Symbol">→</a> <a id="2367" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2373" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="2375" href="Day04.html#2335" class="Function">solve₂′</a> <a id="2383" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="2386" href="Day04.html#2386" class="Bound">boards</a> <a id="2393" class="Symbol">=</a> <a id="2395" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
<a id="2403" href="Day04.html#2335" class="Function">solve₂′</a> <a id="2411" class="Symbol">(</a><a id="2412" href="Day04.html#2412" class="Bound">draw</a> <a id="2417" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2419" href="Day04.html#2419" class="Bound">draws</a><a id="2424" class="Symbol">)</a> <a id="2426" href="Day04.html#2426" class="Bound">boards</a> <a id="2433" class="Symbol">=</a>
  <a id="2437" class="Keyword">let</a>
    <a id="2445" href="Day04.html#2445" class="Bound">boards′</a> <a id="2453" class="Symbol">=</a> <a id="2455" href="Data.List.Base.html#1544" class="Function">List.map</a> <a id="2464" class="Symbol">(</a><a id="2465" href="Day04.html#1353" class="Function">unmark</a> <a id="2472" href="Day04.html#2412" class="Bound">draw</a><a id="2476" class="Symbol">)</a> <a id="2478" href="Day04.html#2426" class="Bound">boards</a>
  <a id="2487" class="Keyword">in</a> <a id="2490" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="2495" href="Data.List.Relation.Unary.Any.html#2668" class="Function">any?</a> <a id="2500" class="Symbol">(</a><a id="2501" href="Data.Bool.Properties.html#1126" class="Function Operator">Bool._≟_</a> <a id="2510" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="2516" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2518" href="Day04.html#704" class="Function">won?</a><a id="2522" class="Symbol">)</a> <a id="2524" href="Day04.html#2445" class="Bound">boards′</a> <a id="2532" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="2535" class="Symbol">λ</a>
    <a id="2541" class="Symbol">{</a> <a id="2543" class="Symbol">(</a><a id="2544" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="2547" class="Symbol">_)</a> <a id="2550" class="Symbol">→</a> <a id="2552" href="Day04.html#2335" class="Function">solve₂′</a> <a id="2560" href="Day04.html#2419" class="Bound">draws</a> <a id="2566" href="Day04.html#2445" class="Bound">boards′</a>
    <a id="2578" class="Symbol">;</a> <a id="2580" class="Symbol">(</a><a id="2581" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2585" href="Day04.html#2585" class="Bound">any</a><a id="2588" class="Symbol">)</a> <a id="2590" class="Symbol">→</a> <a id="2592" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2597" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="2599" href="Day04.html#2412" class="Bound">draw</a> <a id="2604" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="2606" href="Day04.html#967" class="Function">score</a> <a id="2612" class="Symbol">(</a><a id="2613" href="Day04.html#1311" class="Function">mark</a> <a id="2618" href="Day04.html#2412" class="Bound">draw</a> <a id="2623" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="2625" href="Data.List.Relation.Unary.Any.html#1919" class="Function">lookup</a> <a id="2632" href="Day04.html#2585" class="Bound">any</a><a id="2635" class="Symbol">)</a>
    <a id="2641" class="Symbol">}</a>
  <a id="2645" class="Keyword">where</a>
    <a id="2655" class="Keyword">open</a> <a id="2660" class="Keyword">import</a> <a id="2667" href="Data.List.Relation.Unary.Any.html" class="Module">Data.List.Relation.Unary.Any</a> <a id="2696" class="Keyword">using</a> <a id="2702" class="Symbol">(</a><a id="2703" href="Data.List.Relation.Unary.Any.html#2668" class="Function">any?</a><a id="2707" class="Symbol">;</a> <a id="2709" href="Data.List.Relation.Unary.Any.html#1919" class="Function">lookup</a><a id="2715" class="Symbol">)</a>

<a id="solve₂"></a><a id="2718" href="Day04.html#2718" class="Function">solve₂</a> <a id="2725" class="Symbol">:</a> <a id="2727" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2732" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2734" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2736" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2741" href="Day04.html#616" class="Record">Board</a> <a id="2747" class="Symbol">→</a> <a id="2749" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2755" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="2757" href="Day04.html#2718" class="Function">solve₂</a> <a id="2764" class="Symbol">(</a><a id="2765" href="Day04.html#2765" class="Bound">draws</a> <a id="2771" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2773" href="Day04.html#2773" class="Bound">boards</a><a id="2779" class="Symbol">)</a> <a id="2781" class="Symbol">=</a>
  <a id="2785" class="Keyword">let</a>
    <a id="2793" href="Day04.html#2793" class="Bound">final</a> <a id="2799" class="Symbol">:</a> <a id="2801" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2806" href="Day04.html#616" class="Record">Board</a>
    <a id="2816" href="Day04.html#2793" class="Bound">final</a> <a id="2822" class="Symbol">=</a> <a id="2824" href="Data.List.Base.html#1544" class="Function">List.map</a> <a id="2833" class="Symbol">(λ</a> <a id="2836" href="Day04.html#2836" class="Bound">b</a> <a id="2838" class="Symbol">→</a> <a id="2840" href="Data.List.Base.html#4192" class="Function">List.foldr</a> <a id="2851" href="Day04.html#1311" class="Function">mark</a> <a id="2856" href="Day04.html#2836" class="Bound">b</a> <a id="2858" href="Day04.html#2765" class="Bound">draws</a><a id="2863" class="Symbol">)</a> <a id="2865" href="Day04.html#2773" class="Bound">boards</a>

    <a id="2877" href="Day04.html#2877" class="Bound">winning</a> <a id="2885" class="Symbol">:</a> <a id="2887" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2892" href="Day04.html#616" class="Record">Board</a>
    <a id="2902" href="Day04.html#2877" class="Bound">winning</a> <a id="2910" class="Symbol">=</a> <a id="2912" href="Data.List.Base.html#8092" class="Function">List.filter</a> <a id="2924" class="Symbol">(</a><a id="2925" href="Data.Bool.Properties.html#15470" class="Function">T?</a> <a id="2928" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2930" href="Day04.html#704" class="Function">won?</a><a id="2934" class="Symbol">)</a> <a id="2936" href="Day04.html#2793" class="Bound">final</a>
  <a id="2944" class="Keyword">in</a> <a id="2947" href="Day04.html#2335" class="Function">solve₂′</a> <a id="2955" class="Symbol">(</a><a id="2956" href="Data.List.Base.html#9817" class="Function">List.reverse</a> <a id="2969" href="Day04.html#2765" class="Bound">draws</a><a id="2974" class="Symbol">)</a> <a id="2976" href="Day04.html#2877" class="Bound">winning</a>

<a id="solution"></a><a id="2985" href="Day04.html#2985" class="Function">solution</a> <a id="2994" class="Symbol">:</a> <a id="2996" href="Base.html#296" class="Record">Solution</a>
<a id="3005" href="Day04.html#2985" class="Function">solution</a> <a id="3014" class="Symbol">=</a> <a id="3016" class="Keyword">record</a>
  <a id="3025" class="Symbol">{</a> <a id="3027" href="Base.html#358" class="Field">parse</a> <a id="3033" class="Symbol">=</a> <a id="3035" href="Util.html#584" class="Function">runParserMaybe</a> <a id="3050" href="Day04.html#1825" class="Function">parser</a>
  <a id="3059" class="Symbol">;</a> <a id="3061" href="Base.html#381" class="Field">solve₁</a> <a id="3068" class="Symbol">=</a> <a id="3070" href="Data.Maybe.Base.html#1362" class="Function">Maybe.maybe</a> <a id="3082" class="Symbol">(</a><a id="3083" href="Data.Maybe.Base.html#1632" class="Function">Maybe.fromMaybe</a> <a id="3099" class="String">&quot;No solution&quot;</a> <a id="3113" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3115" href="Data.Maybe.Base.html#2020" class="Function">Maybe.map</a> <a id="3125" href="Data.Nat.Show.html#1928" class="Function">ℕ.show</a> <a id="3132" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3134" href="Day04.html#2270" class="Function">solve₁</a><a id="3140" class="Symbol">)</a> <a id="3142" class="String">&quot;No parse&quot;</a>
  <a id="3155" class="Symbol">;</a> <a id="3157" href="Base.html#405" class="Field">solve₂</a> <a id="3164" class="Symbol">=</a> <a id="3166" href="Data.Maybe.Base.html#1362" class="Function">Maybe.maybe</a> <a id="3178" class="Symbol">(</a><a id="3179" href="Data.Maybe.Base.html#1632" class="Function">Maybe.fromMaybe</a> <a id="3195" class="String">&quot;No solution&quot;</a> <a id="3209" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3211" href="Data.Maybe.Base.html#2020" class="Function">Maybe.map</a> <a id="3221" href="Data.Nat.Show.html#1928" class="Function">ℕ.show</a> <a id="3228" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3230" href="Day04.html#2718" class="Function">solve₂</a><a id="3236" class="Symbol">)</a> <a id="3238" class="String">&quot;No parse&quot;</a>
  <a id="3251" class="Symbol">}</a>
</pre></body></html>