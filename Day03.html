<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Day03</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--guardedness</a> <a id="27" class="Symbol">#-}</a>

<a id="32" class="Keyword">module</a> <a id="39" href="Day03.html" class="Module">Day03</a> <a id="45" class="Keyword">where</a>

<a id="52" class="Keyword">open</a> <a id="57" class="Keyword">import</a> <a id="64" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="74" class="Symbol">as</a> <a id="77" class="Module">Bool</a>
<a id="82" class="Keyword">open</a> <a id="87" class="Keyword">import</a> <a id="94" href="Data.Char.html" class="Module">Data.Char</a> <a id="104" class="Symbol">as</a> <a id="107" class="Module">Char</a>
<a id="112" class="Keyword">open</a> <a id="117" class="Keyword">import</a> <a id="124" href="Data.List.html" class="Module">Data.List</a> <a id="134" class="Symbol">as</a> <a id="137" class="Module">List</a> <a id="142" class="Keyword">using</a> <a id="148" class="Symbol">(</a><a id="149" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="153" class="Symbol">;</a> <a id="155" href="Data.List.Base.html#10383" class="InductiveConstructor">[]</a><a id="157" class="Symbol">;</a> <a id="159" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="162" class="Symbol">)</a>
<a id="164" class="Keyword">open</a> <a id="169" class="Keyword">import</a> <a id="176" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="195" class="Symbol">as</a> <a id="198" class="Module">List⁺</a> <a id="204" class="Keyword">using</a> <a id="210" class="Symbol">(</a><a id="211" href="Data.List.NonEmpty.Base.html#1079" class="Record">List⁺</a><a id="216" class="Symbol">)</a>
<a id="218" class="Keyword">open</a> <a id="223" class="Keyword">import</a> <a id="230" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="241" class="Symbol">as</a> <a id="244" class="Module">Maybe</a> <a id="250" class="Keyword">using</a> <a id="256" class="Symbol">(</a><a id="257" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="262" class="Symbol">;</a> <a id="264" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="271" class="Symbol">;</a> <a id="273" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a><a id="277" class="Symbol">)</a>
<a id="279" class="Keyword">open</a> <a id="284" class="Keyword">import</a> <a id="291" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="300" class="Symbol">as</a> <a id="303" class="Module">ℕ</a>
<a id="305" class="Keyword">open</a> <a id="310" class="Keyword">import</a> <a id="317" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a> <a id="331" class="Symbol">as</a> <a id="334" class="Module">ℕ</a>
<a id="336" class="Keyword">open</a> <a id="341" class="Keyword">import</a> <a id="348" href="Data.Product.html" class="Module">Data.Product</a> <a id="361" class="Symbol">as</a> <a id="364" class="Module">×</a>
<a id="366" class="Keyword">open</a> <a id="371" class="Keyword">import</a> <a id="378" href="Data.String.html" class="Module">Data.String</a> <a id="390" class="Symbol">as</a> <a id="393" class="Module">String</a> <a id="400" class="Keyword">using</a> <a id="406" class="Symbol">(</a><a id="407" href="Agda.Builtin.String.html#336" class="Postulate">String</a><a id="413" class="Symbol">)</a>
<a id="415" class="Keyword">open</a> <a id="420" class="Keyword">import</a> <a id="427" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="437" class="Symbol">as</a> <a id="440" class="Module">⊤</a>
<a id="442" class="Keyword">open</a> <a id="447" class="Keyword">import</a> <a id="454" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="463" class="Symbol">as</a> <a id="466" class="Module">Vec</a> <a id="470" class="Keyword">using</a> <a id="476" class="Symbol">(</a><a id="477" href="Data.Vec.Base.html#998" class="Datatype">Vec</a><a id="480" class="Symbol">;</a> <a id="482" href="Data.Vec.Base.html#1034" class="InductiveConstructor">[]</a><a id="484" class="Symbol">;</a> <a id="486" href="Data.Vec.Base.html#1053" class="InductiveConstructor Operator">_∷_</a><a id="489" class="Symbol">)</a>
<a id="491" class="Keyword">open</a> <a id="496" class="Keyword">import</a> <a id="503" href="Function.html" class="Module">Function</a>
<a id="512" class="Keyword">open</a> <a id="517" class="Keyword">import</a> <a id="524" href="Level.html" class="Module">Level</a> <a id="530" class="Symbol">as</a> <a id="533" class="Module">Level</a>

<a id="540" class="Keyword">open</a> <a id="545" class="Keyword">import</a> <a id="552" href="Base.html" class="Module">Base</a>
<a id="557" class="Keyword">open</a> <a id="562" class="Keyword">import</a> <a id="569" href="Util.html" class="Module">Util</a>

<a id="575" class="Keyword">module</a> <a id="582" href="Day03.html#582" class="Module">_</a> <a id="584" class="Keyword">where</a>
  <a id="592" class="Keyword">open</a> <a id="597" class="Keyword">import</a> <a id="604" href="Text.Parser.html" class="Module">Text.Parser</a> <a id="616" href="Level.html#512" class="Function">0ℓ</a>
  <a id="621" class="Keyword">open</a> <a id="626" class="Keyword">import</a> <a id="633" href="Relation.Unary.html" class="Module">Relation.Unary</a>

  <a id="651" href="Day03.html#651" class="Function">bit</a> <a id="655" class="Symbol">:</a> <a id="657" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="660" href="Text.Parser.Types.html#564" class="Record">Parser</a> <a id="667" href="Level.Bounded.html#1072" class="Function Operator">[</a> <a id="669" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="674" href="Level.Bounded.html#1072" class="Function Operator">]</a> <a id="676" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="680" href="Day03.html#651" class="Function">bit</a> <a id="684" class="Symbol">=</a>  <a id="687" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="693" href="Text.Parser.Combinators.html#3232" class="Function Operator">&lt;$</a> <a id="696" href="Text.Parser.Combinators.Char.html#1190" class="Function">char</a> <a id="701" class="String">&#39;0&#39;</a>
     <a id="710" href="Text.Parser.Combinators.html#2489" class="Function Operator">&lt;|&gt;</a> <a id="714" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="719" href="Text.Parser.Combinators.html#3232" class="Function Operator">&lt;$</a> <a id="722" href="Text.Parser.Combinators.Char.html#1190" class="Function">char</a> <a id="727" class="String">&#39;1&#39;</a>

  <a id="734" href="Day03.html#734" class="Function">firstLine</a> <a id="744" class="Symbol">:</a> <a id="746" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="749" href="Text.Parser.Types.html#564" class="Record">Parser</a> <a id="756" href="Level.Bounded.html#1072" class="Function Operator">[</a> <a id="758" href="Data.List.NonEmpty.Base.html#1079" class="Record">List⁺</a> <a id="764" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="769" href="Level.Bounded.html#1072" class="Function Operator">]</a> <a id="771" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="775" href="Day03.html#734" class="Function">firstLine</a> <a id="785" class="Symbol">=</a> <a id="787" href="Text.Parser.Combinators.html#9287" class="Function">list⁺</a> <a id="793" href="Day03.html#651" class="Function">bit</a>

  <a id="800" href="Day03.html#800" class="Function">line</a> <a id="805" class="Symbol">:</a> <a id="807" class="Symbol">(</a><a id="808" href="Day03.html#808" class="Bound">n</a> <a id="810" class="Symbol">:</a> <a id="812" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="813" class="Symbol">)</a> <a id="815" class="Symbol">→</a> <a id="817" class="Symbol">{</a><a id="818" href="Data.Nat.Base.html#2475" class="Function">NonZero</a> <a id="826" href="Day03.html#808" class="Bound">n</a><a id="827" class="Symbol">}</a> <a id="829" class="Symbol">→</a> <a id="831" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="834" href="Text.Parser.Types.html#564" class="Record">Parser</a> <a id="841" href="Level.Bounded.html#1072" class="Function Operator">[</a> <a id="843" href="Data.Vec.Base.html#998" class="Datatype">Vec</a> <a id="847" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="852" href="Day03.html#808" class="Bound">n</a> <a id="854" href="Level.Bounded.html#1072" class="Function Operator">]</a> <a id="856" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="860" href="Day03.html#800" class="Function">line</a> <a id="865" href="Day03.html#865" class="Bound">n</a> <a id="867" class="Symbol">{</a><a id="868" href="Day03.html#868" class="Bound">nonZero</a><a id="875" class="Symbol">}</a> <a id="877" class="Symbol">=</a> <a id="879" href="Text.Parser.Combinators.html#9499" class="Function">replicate</a> <a id="889" href="Day03.html#865" class="Bound">n</a> <a id="891" class="Symbol">{</a><a id="892" href="Day03.html#868" class="Bound">nonZero</a><a id="899" class="Symbol">}</a> <a id="901" href="Day03.html#651" class="Function">bit</a>

  <a id="908" href="Day03.html#908" class="Function">parser</a> <a id="915" class="Symbol">:</a> <a id="917" href="Relation.Unary.html#3359" class="Function">∀[</a> <a id="920" href="Text.Parser.Types.html#564" class="Record">Parser</a> <a id="927" href="Level.Bounded.html#1072" class="Function Operator">[</a> <a id="929" href="Data.Product.html#1806" class="Function">∃[</a> <a id="932" href="Day03.html#932" class="Bound">n</a> <a id="934" href="Data.Product.html#1806" class="Function">]</a> <a id="936" class="Symbol">(</a><a id="937" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="942" class="Symbol">(</a><a id="943" href="Data.Vec.Base.html#998" class="Datatype">Vec</a> <a id="947" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="952" href="Day03.html#932" class="Bound">n</a><a id="953" class="Symbol">))</a> <a id="956" href="Level.Bounded.html#1072" class="Function Operator">]</a> <a id="958" href="Relation.Unary.html#3359" class="Function">]</a>
  <a id="962" href="Day03.html#908" class="Function">parser</a> <a id="969" class="Symbol">=</a> <a id="971" class="Keyword">do</a>
    <a id="978" href="Day03.html#978" class="Bound">first′</a> <a id="985" href="Text.Parser.Combinators.html#4241" class="Function Operator">←</a> <a id="987" href="Day03.html#734" class="Function">firstLine</a>
    <a id="1001" class="Keyword">let</a>
      <a id="1011" href="Day03.html#1011" class="Bound">n</a> <a id="1013" class="Symbol">=</a> <a id="1015" href="Data.List.NonEmpty.Base.html#1372" class="Function">List⁺.length</a> <a id="1028" href="Day03.html#978" class="Bound">first′</a>
      <a id="1041" href="Day03.html#1041" class="Bound">first</a> <a id="1047" class="Symbol">:</a> <a id="1049" href="Data.Vec.Base.html#998" class="Datatype">Vec</a> <a id="1053" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="1058" href="Day03.html#1011" class="Bound">n</a>
      <a id="1066" href="Day03.html#1041" class="Bound">first</a> <a id="1072" class="Symbol">=</a> <a id="1074" href="Data.List.NonEmpty.Base.html#1752" class="Function">List⁺.toVec</a> <a id="1086" href="Day03.html#978" class="Bound">first′</a>

      <a id="1100" href="Day03.html#1100" class="Bound">make</a> <a id="1105" class="Symbol">:</a> <a id="1107" href="Data.List.NonEmpty.Base.html#1079" class="Record">List⁺</a> <a id="1113" class="Symbol">(</a><a id="1114" href="Data.Vec.Base.html#998" class="Datatype">Vec</a> <a id="1118" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="1123" href="Day03.html#1011" class="Bound">n</a><a id="1124" class="Symbol">)</a> <a id="1126" class="Symbol">→</a> <a id="1128" href="Data.Product.html#1806" class="Function">∃[</a> <a id="1131" href="Day03.html#1131" class="Bound">m</a> <a id="1133" href="Data.Product.html#1806" class="Function">]</a> <a id="1135" class="Symbol">(</a><a id="1136" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1141" class="Symbol">(</a><a id="1142" href="Data.Vec.Base.html#998" class="Datatype">Vec</a> <a id="1146" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="1151" href="Day03.html#1131" class="Bound">m</a><a id="1152" class="Symbol">))</a>
      <a id="1161" href="Day03.html#1100" class="Bound">make</a> <a id="1166" href="Day03.html#1166" class="Bound">xs</a> <a id="1169" class="Symbol">=</a> <a id="1171" class="Symbol">(</a><a id="1172" href="Day03.html#1011" class="Bound">n</a> <a id="1174" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1176" href="Day03.html#1041" class="Bound">first</a> <a id="1182" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1184" href="Data.List.NonEmpty.Base.html#1521" class="Function">List⁺.toList</a> <a id="1197" href="Day03.html#1166" class="Bound">xs</a><a id="1199" class="Symbol">)</a>
    <a id="1205" class="Comment">-- TODO: this list does not have to be non-empty.</a>
    <a id="1259" href="Text.Parser.Combinators.html#2357" class="Function">box</a> <a id="1263" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1265" href="Day03.html#1100" class="Bound">make</a> <a id="1270" href="Text.Parser.Combinators.html#3101" class="Function Operator">&lt;$&gt;</a> <a id="1274" href="Text.Parser.Combinators.html#9287" class="Function">list⁺</a> <a id="1280" class="Symbol">(</a><a id="1281" href="Text.Parser.Combinators.Char.html#1406" class="Function">spaces</a> <a id="1288" href="Text.Parser.Combinators.html#6065" class="Function Operator">?&amp;&gt;</a> <a id="1292" href="Day03.html#800" class="Function">line</a> <a id="1297" href="Day03.html#1011" class="Bound">n</a> <a id="1299" href="Text.Parser.Combinators.html#5550" class="Function Operator">&lt;&amp;?</a> <a id="1303" href="Text.Parser.Combinators.html#2357" class="Function">box</a> <a id="1307" href="Text.Parser.Combinators.Char.html#1406" class="Function">spaces</a><a id="1313" class="Symbol">)</a>

<a id="count"></a><a id="1316" href="Day03.html#1316" class="Function">count</a> <a id="1322" class="Symbol">:</a> <a id="1324" class="Symbol">{</a><a id="1325" href="Day03.html#1325" class="Bound">m</a> <a id="1327" href="Day03.html#1327" class="Bound">n</a> <a id="1329" class="Symbol">:</a> <a id="1331" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1332" class="Symbol">}</a> <a id="1334" class="Symbol">→</a> <a id="1336" href="Data.Vec.Base.html#998" class="Datatype">Vec</a> <a id="1340" class="Symbol">(</a><a id="1341" href="Data.Vec.Base.html#998" class="Datatype">Vec</a> <a id="1345" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="1350" href="Day03.html#1325" class="Bound">m</a><a id="1351" class="Symbol">)</a> <a id="1353" href="Day03.html#1327" class="Bound">n</a> <a id="1355" class="Symbol">→</a> <a id="1357" href="Data.Vec.Base.html#998" class="Datatype">Vec</a> <a id="1361" class="Symbol">(</a><a id="1362" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1364" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1366" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1367" class="Symbol">)</a> <a id="1369" href="Day03.html#1327" class="Bound">n</a>
<a id="1371" href="Day03.html#1316" class="Function">count</a> <a id="1377" class="Symbol">=</a> <a id="1379" href="Data.Vec.Base.html#2580" class="Function">Vec.map</a> <a id="1387" href="Day03.html#1554" class="Function">countCol</a>
  <a id="1398" class="Keyword">where</a>
    <a id="1408" href="Day03.html#1408" class="Function">countBit</a> <a id="1417" class="Symbol">:</a> <a id="1419" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="1424" class="Symbol">→</a> <a id="1426" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1428" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1430" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1432" class="Symbol">→</a> <a id="1434" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1436" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1438" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="1444" href="Day03.html#1408" class="Function">countBit</a> <a id="1453" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="1459" class="Symbol">(</a><a id="1460" href="Day03.html#1460" class="Bound">zeros</a> <a id="1466" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1468" href="Day03.html#1468" class="Bound">ones</a><a id="1472" class="Symbol">)</a> <a id="1474" class="Symbol">=</a> <a id="1476" class="Symbol">(</a><a id="1477" class="Number">1</a> <a id="1479" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1481" href="Day03.html#1460" class="Bound">zeros</a> <a id="1487" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1489" href="Day03.html#1468" class="Bound">ones</a><a id="1493" class="Symbol">)</a>
    <a id="1499" href="Day03.html#1408" class="Function">countBit</a> <a id="1508" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="1513" class="Symbol">(</a><a id="1514" href="Day03.html#1514" class="Bound">zeros</a> <a id="1520" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1522" href="Day03.html#1522" class="Bound">ones</a><a id="1526" class="Symbol">)</a> <a id="1528" class="Symbol">=</a> <a id="1530" class="Symbol">(</a><a id="1531" href="Day03.html#1514" class="Bound">zeros</a> <a id="1537" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1539" class="Number">1</a> <a id="1541" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1543" href="Day03.html#1522" class="Bound">ones</a><a id="1547" class="Symbol">)</a>

    <a id="1554" href="Day03.html#1554" class="Function">countCol</a> <a id="1563" class="Symbol">:</a> <a id="1565" class="Symbol">{</a><a id="1566" href="Day03.html#1566" class="Bound">m</a> <a id="1568" class="Symbol">:</a> <a id="1570" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1571" class="Symbol">}</a> <a id="1573" class="Symbol">→</a> <a id="1575" href="Data.Vec.Base.html#998" class="Datatype">Vec</a> <a id="1579" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="1584" href="Day03.html#1566" class="Bound">m</a> <a id="1586" class="Symbol">→</a> <a id="1588" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1590" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1592" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="1598" href="Day03.html#1554" class="Function">countCol</a> <a id="1607" class="Symbol">=</a> <a id="1609" href="Data.Vec.Base.html#4755" class="Function">Vec.foldr</a> <a id="1619" class="Symbol">(</a><a id="1620" href="Function.Base.html#636" class="Function">const</a> <a id="1626" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1628" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1630" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1632" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1633" class="Symbol">)</a> <a id="1635" href="Day03.html#1408" class="Function">countBit</a> <a id="1644" class="Symbol">(</a><a id="1645" class="Number">0</a> <a id="1647" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1649" class="Number">0</a><a id="1650" class="Symbol">)</a>

<a id="binaryToℕ"></a><a id="1653" href="Day03.html#1653" class="Function">binaryToℕ</a> <a id="1663" class="Symbol">:</a> <a id="1665" class="Symbol">{</a><a id="1666" href="Day03.html#1666" class="Bound">n</a> <a id="1668" class="Symbol">:</a> <a id="1670" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1671" class="Symbol">}</a> <a id="1673" class="Symbol">→</a> <a id="1675" href="Data.Vec.Base.html#998" class="Datatype">Vec</a> <a id="1679" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="1684" href="Day03.html#1666" class="Bound">n</a> <a id="1686" class="Symbol">→</a> <a id="1688" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="1690" href="Day03.html#1653" class="Function">binaryToℕ</a> <a id="1700" class="Symbol">=</a> <a id="1702" href="Data.Vec.Base.html#4755" class="Function">Vec.foldr</a> <a id="1712" class="Symbol">(</a><a id="1713" href="Function.Base.html#636" class="Function">const</a> <a id="1719" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1720" class="Symbol">)</a> <a id="1722" class="Symbol">(λ</a> <a id="1725" href="Day03.html#1725" class="Bound">b</a> <a id="1727" href="Day03.html#1727" class="Bound">n</a> <a id="1729" class="Symbol">→</a> <a id="1731" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="1734" href="Day03.html#1725" class="Bound">b</a> <a id="1736" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="1741" class="Number">1</a> <a id="1743" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1745" class="Number">2</a> <a id="1747" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="1749" href="Day03.html#1727" class="Bound">n</a> <a id="1751" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="1756" class="Number">2</a> <a id="1758" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="1760" href="Day03.html#1727" class="Bound">n</a><a id="1761" class="Symbol">)</a> <a id="1763" class="Number">0</a> <a id="1765" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1767" href="Data.Vec.Base.html#7774" class="Function">Vec.reverse</a>

<a id="solve₁′"></a><a id="1780" href="Day03.html#1780" class="Function">solve₁′</a> <a id="1788" class="Symbol">:</a> <a id="1790" class="Symbol">{</a><a id="1791" href="Day03.html#1791" class="Bound">n</a> <a id="1793" class="Symbol">:</a> <a id="1795" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1796" class="Symbol">}</a> <a id="1798" class="Symbol">→</a> <a id="1800" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1805" class="Symbol">(</a><a id="1806" href="Data.Vec.Base.html#998" class="Datatype">Vec</a> <a id="1810" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="1815" href="Day03.html#1791" class="Bound">n</a><a id="1816" class="Symbol">)</a> <a id="1818" class="Symbol">→</a> <a id="1820" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="1822" href="Day03.html#1780" class="Function">solve₁′</a> <a id="1830" href="Day03.html#1830" class="Bound">ns</a> <a id="1833" class="Symbol">=</a>
  <a id="1837" class="Keyword">let</a>
    <a id="1845" href="Day03.html#1845" class="Bound">counts</a> <a id="1852" class="Symbol">=</a> <a id="1854" href="Day03.html#1316" class="Function">count</a> <a id="1860" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1862" href="Data.Vec.Base.html#8576" class="Function">Vec.transpose</a> <a id="1876" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1878" href="Data.Vec.Base.html#7540" class="Function">Vec.fromList</a> <a id="1891" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1893" href="Day03.html#1830" class="Bound">ns</a>
    <a id="1900" href="Day03.html#1900" class="Bound">γ-bin</a> <a id="1906" class="Symbol">=</a> <a id="1908" href="Data.Vec.Base.html#2580" class="Function">Vec.map</a> <a id="1916" href="Day03.html#2033" class="Function">choose-γ</a> <a id="1925" href="Day03.html#1845" class="Bound">counts</a>
    <a id="1936" href="Day03.html#1936" class="Bound">ε-bin</a> <a id="1942" class="Symbol">=</a> <a id="1944" href="Data.Vec.Base.html#2580" class="Function">Vec.map</a> <a id="1952" href="Data.Bool.Base.html#932" class="Function">not</a> <a id="1956" href="Day03.html#1900" class="Bound">γ-bin</a>
    <a id="1966" href="Day03.html#1966" class="Bound">γ</a> <a id="1968" class="Symbol">=</a> <a id="1970" href="Day03.html#1653" class="Function">binaryToℕ</a> <a id="1980" href="Day03.html#1900" class="Bound">γ-bin</a>
    <a id="1990" href="Day03.html#1990" class="Bound">ε</a> <a id="1992" class="Symbol">=</a> <a id="1994" href="Day03.html#1653" class="Function">binaryToℕ</a> <a id="2004" href="Day03.html#1936" class="Bound">ε-bin</a>
  <a id="2012" class="Keyword">in</a> <a id="2015" href="Day03.html#1966" class="Bound">γ</a> <a id="2017" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="2019" href="Day03.html#1990" class="Bound">ε</a>
  <a id="2023" class="Keyword">where</a>
    <a id="2033" href="Day03.html#2033" class="Function">choose-γ</a> <a id="2042" class="Symbol">:</a> <a id="2044" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2046" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2048" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2050" class="Symbol">→</a> <a id="2052" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
    <a id="2061" href="Day03.html#2033" class="Function">choose-γ</a> <a id="2070" class="Symbol">(</a><a id="2071" href="Day03.html#2071" class="Bound">zeros</a> <a id="2077" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2079" href="Day03.html#2079" class="Bound">ones</a><a id="2083" class="Symbol">)</a> <a id="2085" class="Symbol">=</a> <a id="2087" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="2090" href="Day03.html#2071" class="Bound">zeros</a> <a id="2096" href="Data.Nat.Base.html#1321" class="Function Operator">≤ᵇ</a> <a id="2099" href="Day03.html#2079" class="Bound">ones</a> <a id="2104" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="2109" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="2114" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="2119" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>

<a id="solve₁"></a><a id="2126" href="Day03.html#2126" class="Function">solve₁</a> <a id="2133" class="Symbol">:</a> <a id="2135" href="Data.Product.html#1806" class="Function">∃[</a> <a id="2138" href="Day03.html#2138" class="Bound">n</a> <a id="2140" href="Data.Product.html#1806" class="Function">]</a> <a id="2142" class="Symbol">(</a><a id="2143" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2148" class="Symbol">(</a><a id="2149" href="Data.Vec.Base.html#998" class="Datatype">Vec</a> <a id="2153" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="2158" href="Day03.html#2138" class="Bound">n</a><a id="2159" class="Symbol">))</a> <a id="2162" class="Symbol">→</a> <a id="2164" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="2166" href="Day03.html#2126" class="Function">solve₁</a> <a id="2173" class="Symbol">(_</a> <a id="2176" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2178" href="Day03.html#2178" class="Bound">xs</a><a id="2180" class="Symbol">)</a> <a id="2182" class="Symbol">=</a> <a id="2184" href="Day03.html#1780" class="Function">solve₁′</a> <a id="2192" href="Day03.html#2178" class="Bound">xs</a>

<a id="solution"></a><a id="2196" href="Day03.html#2196" class="Function">solution</a> <a id="2205" class="Symbol">:</a> <a id="2207" href="Base.html#296" class="Record">Solution</a>
<a id="2216" href="Day03.html#2196" class="Function">solution</a> <a id="2225" class="Symbol">=</a> <a id="2227" class="Keyword">record</a>
  <a id="2236" class="Symbol">{</a> <a id="2238" href="Base.html#358" class="Field">parse</a> <a id="2244" class="Symbol">=</a> <a id="2246" href="Util.html#584" class="Function">runParserMaybe</a> <a id="2261" href="Day03.html#908" class="Function">parser</a>
  <a id="2270" class="Symbol">;</a> <a id="2272" href="Base.html#381" class="Field">solve₁</a> <a id="2279" class="Symbol">=</a> <a id="2281" href="Data.Maybe.Base.html#1362" class="Function">maybe</a> <a id="2287" class="Symbol">(</a><a id="2288" href="Data.Nat.Show.html#1928" class="Function">ℕ.show</a> <a id="2295" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2297" href="Day03.html#2126" class="Function">solve₁</a><a id="2303" class="Symbol">)</a> <a id="2305" class="String">&quot;No parse&quot;</a>
    <a id="2320" class="Comment">-- TODO</a>
  <a id="2330" class="Symbol">;</a> <a id="2332" href="Base.html#405" class="Field">solve₂</a> <a id="2339" class="Symbol">=</a> <a id="2341" href="Function.Base.html#636" class="Function">const</a> <a id="2347" class="String">&quot;Not solved yet&quot;</a>
  <a id="2366" class="Symbol">}</a> <a id="2368" class="Keyword">where</a>
  <a id="2376" class="Keyword">open</a> <a id="2381" class="Keyword">import</a> <a id="2388" href="Data.Maybe.html" class="Module">Data.Maybe</a>
</pre></body></html>